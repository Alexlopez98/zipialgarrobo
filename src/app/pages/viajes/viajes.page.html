<ion-header class="ion-no-border">
  <ion-toolbar style="--background: transparent;">
    <ion-buttons slot="start">
      <ion-back-button 
        defaultHref="/home" 
        icon="arrow-back-outline" 
        text="" 
        style="color: #073166; font-size: 24px;">
      </ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding viajes-page">

  <div class="login-header">
    <img src="assets/icon/logo.png" alt="Zipi Algarrobo" class="app-logo" />
    <h2 class="titulo" style="color: #073166; font-weight: 700; margin-top: 10px;">MIS VIAJES</h2>
  </div>

  <div *ngIf="viajes.length === 0" class="empty-state" style="text-align: center; margin-top: 50px; opacity: 0.6; color: #666;">
    <ion-icon name="car-sport-outline" style="font-size: 60px; margin-bottom: 10px;"></ion-icon>
    <p>No tienes viajes registrados aÃºn.</p>
  </div>

  <div class="viajes-container" *ngIf="viajes.length > 0">
    <div class="viaje-item" *ngFor="let viaje of viajes" style="background: white; padding: 15px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 15px;">
      
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
        <p class="destino-text" style="margin: 0; font-size: 1.1rem; color: #333;"><strong>{{ viaje.destino }}</strong></p>
        <p class="precio-tag" style="margin: 0; color: #2dd36f; font-weight: bold; font-size: 1.1rem;">
          {{ viaje.costo }}
        </p>
      </div>

      <p class="conductor-text" style="margin: 5px 0; color: #555;">Conductor: <strong>{{ viaje.conductor }}</strong></p>
      
      <p style="font-size: 13px; color: #888; margin-top: 5px; display: flex; align-items: center;">
        <ion-icon name="calendar-outline" style="margin-right: 5px;"></ion-icon> 
        {{ viaje.fecha }}
      </p>

      <div class="calificacion-box" style="margin-top: 15px; padding-top: 10px; border-top: 1px solid #f0f0f0;">
        <div class="stars" style="display: flex; justify-content: center;">
          <ion-icon
            *ngFor="let star of [1, 2, 3, 4, 5]"
            [name]="star <= viaje.calificacion ? 'star' : 'star-outline'"
            [style.color]="star <= viaje.calificacion ? '#ffc409' : '#ccc'"
            (click)="calificar(viaje, star)"
            style="font-size: 28px; margin: 0 4px; cursor: pointer;">
          </ion-icon>
        </div>

        <div *ngIf="viaje.calificado" class="resultado" style="text-align: center; margin-top: 8px; font-size: 14px; color: #186987; font-weight: 500;">
          Tu calificaciÃ³n: {{ viaje.calificacion }}/5
        </div>
      </div>
      
    </div>
  </div>

  <ion-button 
    expand="block" 
    class="btn-limpiar" 
    fill="outline" 
    (click)="limpiarHistorial()" 
    [disabled]="viajes.length === 0"
    style="margin-top: 30px; margin-bottom: 40px; --color: #eb445a; --border-color: #eb445a; --border-radius: 20px;">
    <ion-icon name="trash-outline" slot="start"></ion-icon>
    LIMPIAR HISTORIAL
  </ion-button>

  <div class="rating-animation" *ngIf="mostrarAnimacion" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.9); z-index: 9999; display: flex; align-items: center; justify-content: center;">
    <div class="animation-content" style="text-align: center;">
      <ng-lottie
        [options]="animacionEstrellas"
        width="200"
        height="200">
      </ng-lottie>
      <h3 style="color: #186987; margin-top: 20px;">Â¡Gracias por tu calificaciÃ³n! ðŸŒŸ</h3>
    </div>
  </div>

</ion-content>